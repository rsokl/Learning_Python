

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Array Broadcasting &mdash; Fundamentals of Python alpha documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/my_theme.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Fundamentals of Python alpha documentation" href="../index.html"/>
        <link rel="up" title="Module 3: The Essentials of NumPy" href="../module_3.html"/>
        <link rel="prev" title="“Vectorized” Operations: Optimized Computations on NumPy Arrays" href="VectorizedOperations.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Fundamentals of Python
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Essentials of Python, for Data Science Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../module_1.html">Module 1: Getting Started with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../module_2.html">Module 2: The Essentials of Python</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../module_3.html">Module 3: The Essentials of NumPy</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="IntroducingTheNDarray.html">Introducing the ND-array</a></li>
<li class="toctree-l2"><a class="reference internal" href="AccessingDataAlongMultipleDimensions.html">Accessing Data Along Multiple Dimensions in an Array</a></li>
<li class="toctree-l2"><a class="reference internal" href="BasicArrayAttributes.html">Basic Array Attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="FunctionsForCreatingNumpyArrays.html">Functions for Creating NumPy Arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="ReshapingArrays.html">Reshaping Arrays &amp; Array-Traversal Order</a></li>
<li class="toctree-l2"><a class="reference internal" href="VectorizedOperations.html">“Vectorized” Operations: Optimized Computations on NumPy Arrays</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Array Broadcasting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#A-Simple-Example-of-Array-Broadcasting">A Simple Example of Array Broadcasting</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Rules-of-Broadcasting">Rules of Broadcasting</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Size-1-Axes-&amp;-The-newaxis-Object">Size-1 Axes &amp; The <code class="docutils literal"><span class="pre">newaxis</span></code> Object</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Reading-Comprehension-Solutions">Reading Comprehension Solutions</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Fundamentals of Python</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../module_3.html">Module 3: The Essentials of NumPy</a> &raquo;</li>
        
      <li>Array Broadcasting</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/Module3_IntroducingNumpy/Broadcasting.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="Array-Broadcasting">
<h1>Array Broadcasting<a class="headerlink" href="#Array-Broadcasting" title="Permalink to this headline">¶</a></h1>
<div class="section" id="A-Simple-Example-of-Array-Broadcasting">
<h2>A Simple Example of Array Broadcasting<a class="headerlink" href="#A-Simple-Example-of-Array-Broadcasting" title="Permalink to this headline">¶</a></h2>
<p>In this section, we will discuss the NumPy’s array broadcasting
mechanism for performing vectorized mathematical operations on arrays of
<em>unequal</em> shape. Let’s immediately take an example into consideration to
see array broadcasting in action. Suppose you have a grade book for 6
students,each of whom have taken 3 exams; naturally, you store these
scores in a shape-(6,3) array:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># grades for 6 students who have taken 3 exams</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">grades</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.79</span><span class="p">,</span>  <span class="mf">0.84</span><span class="p">,</span>  <span class="mf">0.84</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.87</span><span class="p">,</span>  <span class="mf">0.93</span><span class="p">,</span>  <span class="mf">0.78</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.77</span><span class="p">,</span>  <span class="mf">1.</span>  <span class="p">,</span>  <span class="mf">0.87</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.66</span><span class="p">,</span>  <span class="mf">0.75</span><span class="p">,</span>  <span class="mf">0.82</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.84</span><span class="p">,</span>  <span class="mf">0.89</span><span class="p">,</span>  <span class="mf">0.76</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.83</span><span class="p">,</span>  <span class="mf">0.71</span><span class="p">,</span>  <span class="mf">0.85</span><span class="p">]])</span>
</pre></div>
</div>
<p>We might be interested to see how each of these scores compare to the
mean score for that specific exam. Based on our discussion from the last
section, we can easily compute the mean-score for each exam (rounded to
2 decimal places):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># compute the mean score for each exam (rounded to 2 decimal places)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mean_exam_scores</span> <span class="o">=</span> <span class="n">grades</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mean_exam_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">mean_exam_scores</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">mean_exam_scores</span>
<span class="n">array</span><span class="p">([</span> <span class="mf">0.79</span><span class="p">,</span>  <span class="mf">0.85</span><span class="p">,</span>  <span class="mf">0.82</span><span class="p">])</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">grades</span></code> is a shape-(6,3) array and <code class="docutils literal"><span class="pre">mean_exam_scores</span></code> is a
shape-(3,) array, and we want to compute the offset of each exam score
from its respective mean. At first glance, it seems like we will have to
loop over each row of our <code class="docutils literal"><span class="pre">grades</span></code> array and subtract from it the
<code class="docutils literal"><span class="pre">mean_exam_scores</span></code>, to compute the offset of each exam score from the
respective mean-score:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Using a for-loop to compute score offsets.</span>

<span class="c1"># Shape-(6,3) array that will store (score - mean) for each</span>
<span class="c1"># exam score.</span>
<span class="n">score_offset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">grades</span><span class="p">)</span>

<span class="c1"># iterates over each row of `grades`</span>
<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">scores_per_student</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">grades</span><span class="p">):</span>
    <span class="c1"># `scores_per_student` is a shape-(3,) array of exam scores</span>
    <span class="c1"># for a given student. This matches the shape of</span>
    <span class="c1"># `mean_exam_scores`, thus we can perform this subtraction</span>
    <span class="n">score_offset</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">scores_per_student</span> <span class="o">-</span> <span class="n">mean_exam_scores</span>
</pre></div>
</div>
<p>Given our discussion of vectorized operations from the last section, you
should recoil at the sight of a for-loop in code that is performing
array-arithmetic. We might as well get out our abacuses and spreadsheets
at this point. Fortunately, NumPy provides a mechanism called array
broadcasting, which allows us to compute these offsets in a concise,
vectorized way:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Using broadcasting to subtract a shape-(3,) array</span>
<span class="c1"># from a shape-(6,3) array.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">score_offset</span> <span class="o">=</span> <span class="n">grades</span> <span class="o">-</span> <span class="n">mean_exam_scores</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">score_offset</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.08</span><span class="p">,</span>  <span class="mf">0.08</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.04</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.15</span><span class="p">,</span>  <span class="mf">0.05</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">0.13</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span> <span class="p">,</span>  <span class="mf">0.</span>  <span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.05</span><span class="p">,</span>  <span class="mf">0.04</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.06</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.04</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.14</span><span class="p">,</span>  <span class="mf">0.03</span><span class="p">]])</span>
</pre></div>
</div>
<p>When you invoke <code class="docutils literal"><span class="pre">grades</span> <span class="pre">-</span> <span class="pre">mean_exam_scores</span></code>, NumPy will recognize that
<code class="docutils literal"><span class="pre">mean_exam_scores</span></code> has the same shape as each row of <code class="docutils literal"><span class="pre">grades</span></code> and
thus it will apply the subtraction operation on <em>each</em> row of <code class="docutils literal"><span class="pre">grades</span></code>
with <code class="docutils literal"><span class="pre">mean_exam_scores</span></code>. What has transpired here is an example of
<em>array broadcasting</em>. NumPy has effectively replicated the content of
<code class="docutils literal"><span class="pre">mean_exam_scores</span></code> such that it is now a shape-(6,3) array, which is
thus compatible for subtraction with <code class="docutils literal"><span class="pre">grades</span></code>. That is, the content of
<code class="docutils literal"><span class="pre">mean_exam_scores</span></code> has effectively been <em>broadcasted</em> to fill a
shape-(6,3) array:</p>
<div class="math">
\begin{equation}
\left( \begin{array}{*{3}{X}}
  0.79 &amp; 0.84 &amp; 0.84 \\
  0.87 &amp; 0.93 &amp; 0.78 \\
  0.77 &amp; 1.00 &amp; 0.87 \\
  0.66 &amp; 0.75 &amp; 0.82 \\
  0.84 &amp; 0.89 &amp; 0.76 \\
  0.83 &amp; 0.71 &amp; 0.85
\end{array} \right)
%
- \left( \begin{array}{*{3}{X}}
  0.79 &amp; 0.85 &amp; 0.82
\end{array}\right)
%
\rightarrow \left( \begin{array}{*{3}{X}}
  0.79 &amp; 0.84 &amp; 0.84 \\
  0.87 &amp; 0.93 &amp; 0.78 \\
  0.77 &amp; 1.00 &amp; 0.87 \\
  0.66 &amp; 0.75 &amp; 0.82 \\
  0.84 &amp; 0.89 &amp; 0.76 \\
  0.83 &amp; 0.71 &amp; 0.85
\end{array} \right)
%
- \left( \begin{array}{*{3}{X}}
  0.79 &amp; 0.85 &amp; 0.82 \\
  0.79 &amp; 0.85 &amp; 0.82 \\
  0.79 &amp; 0.85 &amp; 0.82 \\
  0.79 &amp; 0.85 &amp; 0.82 \\
  0.79 &amp; 0.85 &amp; 0.82 \\
  0.79 &amp; 0.85 &amp; 0.82
\end{array}\right)
\
\end{equation}</div><p>The word “effectively” is used here because NumPy doesn’t really create
this broadcasted version of <code class="docutils literal"><span class="pre">mean_exam_scores</span></code> behind the scenes; it
is able to do the necessary computations without having to redundantly
copy the contents of <code class="docutils literal"><span class="pre">mean_exam_scores</span></code> into a shape-(6,3) array.
Doing so would be a waste of memory and computation. That being said,
this replication process conveys exactly the mathematics of broadcast
operations between arrays; thus the preceding diagram reflects how you
should always envision broadcasting.</p>
<div class="admonition note">
<p class="first fa fa-exclamation-circle"><strong>Definition: Array Broadcasting</strong>:</p>
<p class="last"><strong>Array broadcasting</strong> is a mechanism used by NumPy to permit vectorized
mathematical operations between arrays of unequal, but compatible
shapes. Specifically, an array will be treated as if its contents have
been replicated along appropriate the dimensions, such that the shape of
this new, higher-dimensional array suites the mathematical operation
being performed.</p>
</div>
<p>NumPy provides the function
<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.broadcast_to.html#numpy.broadcast_to">broadcast_to</a>,
which can be used to broadcast an array to a specified shape. This can
help us build our intuition for broadcasting. Let’s broadcast a
shape-(3,4) array to a shape-(2,3,4) array:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Using `np.broadcast_to`; here we broadcast a</span>
<span class="c1"># shape-(3,4) array to a shape-(2,3,4) array.</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
                  <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
                  <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">array</span><span class="p">([[[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]],</span>

       <span class="p">[[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]]])</span>
</pre></div>
</div>
<p>The importance of broadcasting should be manifestly clear. We could now,
say, compute the position of tens of thousands of particles relative to
their center of mass, in a concise and highly-optimized way. That being
said, there are rules that dictate how NumPy performs its broadcasting,
and what conditions makes two arrays broadcast-compatible. We will spend
the rest of this section discussing these rules and further developing
our intuition for broadcasting.</p>
<hr class="docutils" />
<p><strong>Reading Comprehension: Basic Broadcasting</strong></p>
<p>Generate a random array of 10,000 2D points using <code class="docutils literal"><span class="pre">np.random.rand</span></code>.
Compute the “center of mass” of these points, which is simply the
average x-coordinate and the average y-coordinate of these 10,000
points. Then, use broadcasting to compute the shape-(10000,2) array that
stores the position of the points <em>relative</em> to the center of mass. For
example, if the center of mass is <span class="math">\((0.5, 1)\)</span>, and the absolute
position of a point is <span class="math">\((2, 3)\)</span>, then the position of that point
<em>relative</em> to the center of mass is simply
<span class="math">\((2, 3) - (0.5, 1) = (1.5, 2)\)</span></p>
</div>
<hr class="docutils" />
<div class="section" id="Rules-of-Broadcasting">
<h2>Rules of Broadcasting<a class="headerlink" href="#Rules-of-Broadcasting" title="Permalink to this headline">¶</a></h2>
<p>Array broadcasting cannot accommodate arbitrary combinations of array
shapes. For example, a (7,5)-shape array is incompatible with a
shape-(11,3) array. Trying to add two such arrays would produce a
<code class="docutils literal"><span class="pre">ValueError</span></code>. To determine if two arrays are broadcast-compatible,
line up their shapes so that their trailing dimensions are aligned, and
then check that each pair of aligned dimensions satisfy either of the
following conditions:</p>
<ul class="simple">
<li>the aligned dimensions have the same size</li>
<li>one of the dimensions has a size of 1</li>
</ul>
<p>The two arrays are broadcast-compatible if either of these conditions
are satisfied for each pair of aligned dimensions. It is okay to have
one array with a higher-dimensionality and thus to have “dangling”
leading dimensions. Any size-1 dimension or “missing” dimension will be
filled-in by broadcasting the content of that array.</p>
<p>Taking our grade-book example from the preceding subsection, let’s see
that the shape-(6,3) and shape-(3,) arrays satisfy these rules for
broadcast-compatibility:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>     <span class="n">array</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">6</span> <span class="n">x</span> <span class="mi">3</span>
     <span class="n">array</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span>     <span class="mi">3</span>
<span class="n">result</span><span class="o">-</span><span class="n">shape</span><span class="p">:</span> <span class="mi">6</span> <span class="n">x</span> <span class="mi">3</span>
</pre></div>
</div>
<p>Let’s look an assortment of pairs of array-shapes and see whether or not
they are broadcast-compatible:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>     <span class="n">array</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>         <span class="mi">8</span>
     <span class="n">array</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">5</span> <span class="n">x</span> <span class="mi">2</span> <span class="n">x</span> <span class="mi">8</span>
<span class="n">result</span><span class="o">-</span><span class="n">shape</span><span class="p">:</span> <span class="mi">5</span> <span class="n">x</span> <span class="mi">2</span> <span class="n">x</span> <span class="mi">8</span>

     <span class="n">array</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>     <span class="mi">5</span> <span class="n">x</span> <span class="mi">2</span>
     <span class="n">array</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">5</span> <span class="n">x</span> <span class="mi">4</span> <span class="n">x</span> <span class="mi">2</span>
<span class="n">result</span><span class="o">-</span><span class="n">shape</span><span class="p">:</span> <span class="n">INCOMPATIBLE</span>

     <span class="n">array</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>     <span class="mi">4</span> <span class="n">x</span> <span class="mi">2</span>
     <span class="n">array</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">5</span> <span class="n">x</span> <span class="mi">4</span> <span class="n">x</span> <span class="mi">2</span>
<span class="n">result</span><span class="o">-</span><span class="n">shape</span><span class="p">:</span> <span class="mi">5</span> <span class="n">x</span> <span class="mi">4</span> <span class="n">x</span> <span class="mi">2</span>

     <span class="n">array</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">8</span> <span class="n">x</span> <span class="mi">1</span> <span class="n">x</span> <span class="mi">3</span>
     <span class="n">array</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">8</span> <span class="n">x</span> <span class="mi">5</span> <span class="n">x</span> <span class="mi">3</span>
<span class="n">result</span><span class="o">-</span><span class="n">shape</span><span class="p">:</span> <span class="mi">8</span> <span class="n">x</span> <span class="mi">5</span> <span class="n">x</span> <span class="mi">3</span>

     <span class="n">array</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">5</span> <span class="n">x</span> <span class="mi">1</span> <span class="n">x</span> <span class="mi">3</span> <span class="n">x</span> <span class="mi">2</span>
     <span class="n">array</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span>     <span class="mi">9</span> <span class="n">x</span> <span class="mi">1</span> <span class="n">x</span> <span class="mi">2</span>
<span class="n">result</span><span class="o">-</span><span class="n">shape</span><span class="p">:</span> <span class="mi">5</span> <span class="n">x</span> <span class="mi">9</span> <span class="n">x</span> <span class="mi">3</span> <span class="n">x</span> <span class="mi">2</span>

     <span class="n">array</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span> <span class="n">x</span> <span class="mi">3</span> <span class="n">x</span> <span class="mi">2</span>
     <span class="n">array</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span>     <span class="mi">8</span> <span class="n">x</span> <span class="mi">2</span>
<span class="n">result</span><span class="o">-</span><span class="n">shape</span><span class="p">:</span> <span class="n">INCOMPATIBLE</span>

     <span class="n">array</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">2</span> <span class="n">x</span> <span class="mi">1</span>
     <span class="n">array</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span>     <span class="mi">1</span>
<span class="n">result</span><span class="o">-</span><span class="n">shape</span><span class="p">:</span> <span class="mi">2</span> <span class="n">x</span> <span class="mi">1</span>
</pre></div>
</div>
<hr class="docutils" />
<p><strong>Reading Comprehension: Broadcast Compatibility</strong></p>
<p>Given the following pairs of array-shapes, determine what the resulting
broadcasted shapes will be. Indicate if a pair is
broadcast-incompatible.</p>
<ol class="arabic simple">
<li><code class="docutils literal"><span class="pre">7</span> <span class="pre">x</span> <span class="pre">2</span></code> with <code class="docutils literal"><span class="pre">7</span></code></li>
<li><code class="docutils literal"><span class="pre">4</span></code> with <code class="docutils literal"><span class="pre">3</span> <span class="pre">x</span> <span class="pre">4</span></code></li>
<li><code class="docutils literal"><span class="pre">1</span> <span class="pre">x</span> <span class="pre">3</span> <span class="pre">x</span> <span class="pre">1</span></code> with <code class="docutils literal"><span class="pre">8</span> <span class="pre">x</span> <span class="pre">1</span> <span class="pre">x</span> <span class="pre">1</span></code></li>
<li><code class="docutils literal"><span class="pre">9</span> <span class="pre">x</span> <span class="pre">2</span> <span class="pre">x</span> <span class="pre">5</span></code> with <code class="docutils literal"><span class="pre">2</span> <span class="pre">x</span> <span class="pre">5</span></code></li>
<li><code class="docutils literal"><span class="pre">3</span></code> with <code class="docutils literal"><span class="pre">3</span> <span class="pre">x</span> <span class="pre">3</span> <span class="pre">x</span> <span class="pre">2</span></code></li>
</ol>
</div>
<hr class="docutils" />
<div class="section" id="Size-1-Axes-&amp;-The-newaxis-Object">
<h2>Size-1 Axes &amp; The <code class="docutils literal"><span class="pre">newaxis</span></code> Object<a class="headerlink" href="#Size-1-Axes-&-The-newaxis-Object" title="Permalink to this headline">¶</a></h2>
<p>Here we will learn the utility of introducing size-1 dimensions into an
array.</p>
<p>Dimensions of size-1 are special in that they can be broadcasted to any
size necessary. Additionally, recalling the rules for reshaping an
array, you can introduce size-1 dimensions to an array without changing
the overall size (i.e.&nbsp;total number of entries in an array. Thus we are
free to add size-1 dimensions to an array as-needed (we will see why
this can be useful in a moment). Let’s reshape a shape-(3,) array into a
shape-(1, 3, 1, 1) array:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">array([[[[1]],</span>

<span class="go">        [[2]],</span>

<span class="go">        [[3]]]])</span>
</pre></div>
</div>
<p>Thus the 1-D array with three entries has been reshaped to possess
4-dimensions: “one stack of three sheets, each containing a single row
and column”. There is another way to introduce size-1 dimensions. NumPy
provides the <code class="docutils literal"><span class="pre">newaxis</span></code> object for this purpose. Let’s immediately
demonstrate how <code class="docutils literal"><span class="pre">np.newaxis</span></code> can be used:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># demonstrating the usage of the `numpy.newaxis` object</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y</span><span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y</span>
<span class="n">array</span><span class="p">([[[[</span><span class="mi">1</span><span class="p">]],</span>

        <span class="p">[[</span><span class="mi">2</span><span class="p">]],</span>

        <span class="p">[[</span><span class="mi">3</span><span class="p">]]]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>See that including <code class="docutils literal"><span class="pre">np.newaxis</span></code> objects when indexing <code class="docutils literal"><span class="pre">x</span></code> returns a
“view” of <code class="docutils literal"><span class="pre">x</span></code>, with size-1 dimensions inserted correspondingly. The
resulting array is not a copy of <code class="docutils literal"><span class="pre">x</span></code>, it points to the exact same data
as <code class="docutils literal"><span class="pre">x</span></code>, but merely with a different indexing layout. This is no
different than what we achieved via reshaping.</p>
<p>Moving on to a more pressing matter: why would we ever want to introduce
these spurious dimensions into an array? Let’s take an example to
demonstrate the utility of size-1 dimensions. Suppose that we want to
multiply all possible pairs of entries between two arrays:
<code class="docutils literal"><span class="pre">array([1,</span> <span class="pre">2,</span> <span class="pre">3])</span></code> with <code class="docutils literal"><span class="pre">array([[4,</span> <span class="pre">5,</span> <span class="pre">6,</span> <span class="pre">7]])</span></code>. That is, we want to
perform twelve multiplications, and have access to each result. At first
glance, combining a shape-(3,) array with a shape-(4,) array seems
inadmissible for broadcasting; we seem to be doomed to perform nested
for-loops like a bunch of cavemen and cavewomen. Fortunately, we can
make clever use of size-1 dimensions so that we can perform this
computation in a vectorized way.</p>
<p>Let’s introduce size-1 dimensions into both arrays as so:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># inserting size-1 dimensions into `x` and `y` in</span>
<span class="c1"># preparation of broadcasting</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x_1d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">x_1d</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">]])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">y_1d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y_1d</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]])</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">x</span></code> is now a shape-(1, 3) array and <code class="docutils literal"><span class="pre">y</span></code> is a shape-(4, 1) array.
According to the broadcasting rules, these arrays are broadcast
compatible and will multiply to produce a shape-(3, 4) array. Let’s see
that multiplying these two arrays will exactly produce the twelve
numbers that we are after:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># broadcast-multiplying `x` and `y`</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>
<span class="n">array</span><span class="p">([[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">21</span><span class="p">]])</span>
</pre></div>
</div>
<div class="math">
\begin{equation}
\left(
\begin{array}{*{1}{X}}
  \left(1\right) \\
  \left(2\right) \\
  \left(3\right)
\end{array} \right)
%
\times \left(\left( \begin{array}{*{4}{X}}
  4 &amp; 5 &amp; 6 &amp; 7
\end{array}\right)\right)
%
\rightarrow \left( \begin{array}{*{4}{X}}
  1 &amp; 1 &amp; 1 &amp; 1 \\
  2 &amp; 2 &amp; 2 &amp; 2 \\
  3 &amp; 3 &amp; 3 &amp; 3
\end{array}\right)
%
\times \left( \begin{array}{*{4}{X}}
  4 &amp; 5 &amp; 6 &amp; 7 \\
  4 &amp; 5 &amp; 6 &amp; 7 \\
  4 &amp; 5 &amp; 6 &amp; 7
\end{array}\right)
%
= \left( \begin{array}{*{4}{X}}
  1\times4 &amp; 1\times5 &amp; 1\times6 &amp; 1\times7 \\
  2\times4 &amp; 2\times5 &amp; 2\times6 &amp; 2\times7 \\
  3\times4 &amp; 3\times5 &amp; 3\times6 &amp; 3\times7
\end{array}\right)
\
\end{equation}</div><p>See that entry <code class="docutils literal"><span class="pre">(i,</span> <span class="pre">j)</span></code> of the resulting array corresponds to
<code class="docutils literal"><span class="pre">x_1d[i]</span> <span class="pre">*</span> <span class="pre">y_1d[j]</span></code>.</p>
<p>Through the use of simple reshaping, shrewdly inserting size-1
dimensions allowed us to coerce NumPy into performing exactly the
combination-multiplication that we desired. Furthermore, a keen
understanding of what broadcasting is provides us with a clear
interpretation of the structure of the result of this calculation. That
is, if I reshape <code class="docutils literal"><span class="pre">x</span></code> to be a shape-(M, 1) array, and I reshape <code class="docutils literal"><span class="pre">y</span></code>
to be a shape-(1, N) array, then (according to broadcasting rules)
<code class="docutils literal"><span class="pre">x</span> <span class="pre">*</span> <span class="pre">y</span></code> would produce a shape-(M, N) array storing the multiplication
of each of <code class="docutils literal"><span class="pre">x</span></code>’s M numbers with each of <code class="docutils literal"><span class="pre">y</span></code>’s N numbers.</p>
<hr class="docutils" />
<p><strong>Reading Comprehension: Basic Broadcasting II</strong></p>
<p>Given the shape-(2,3,4) array:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
<span class="go">                   [ 4,  5,  6,  7],</span>
<span class="go">                   [ 8,  9, 10, 11]],</span>

<span class="go">                  [[12, 13, 14, 15],</span>
<span class="go">                   [16, 17, 18, 19],</span>
<span class="go">                   [20, 21, 22, 23]]])</span>
</pre></div>
</div>
<p>Normalize <code class="docutils literal"><span class="pre">x</span></code> such that <em>each of its rows, within each sheet, will sum
to a value of 1</em>. Make use of the sequential function <code class="docutils literal"><span class="pre">np.sum</span></code>, which
should be called only once, and broadcast-division.</p>
<hr class="docutils" />
<hr class="docutils" />
<p><strong>Reading Comprehension: Basic Broadcasting III</strong></p>
<p>A digital image is simply an array of numbers, which instructs a grid of
pixels on a monitor to shine light of specific colors, according to the
numerical values in that array.</p>
<p>An RGB-image can thus be stored as a 3D NumPy array of
shape-<span class="math">\((V, H, 3)\)</span>. <span class="math">\(V\)</span> is the number of pixels along the
vertical direction, <span class="math">\(H\)</span> is the number of pixels along the
horizontal, and the size-3 dimension stores the red, blue, and green
color values for a given pixel. Thus a <span class="math">\((32, 32, 3)\)</span> array would
be a 32x32 RBG image.</p>
<p>You often work with a collection of images. Suppose we want to store N
images in a single array; thus we now consider a 4D shape-(N, V, H, 3)
array. For the sake of convenience, let’s simply generate a 4D-array of
random numbers as a placeholder for real image data. We will generate
500, 48x48 RGB images:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">images</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>Using the sequential function <code class="docutils literal"><span class="pre">np.max</span></code> and broadcasting, normalize
<code class="docutils literal"><span class="pre">images</span></code> such that the largest value within each color-channel of each
image is 1.</p>
</div>
<hr class="docutils" />
<div class="section" id="Reading-Comprehension-Solutions">
<h2>Reading Comprehension Solutions<a class="headerlink" href="#Reading-Comprehension-Solutions" title="Permalink to this headline">¶</a></h2>
<p><strong>Basic Broadcasting: Solution</strong></p>
<p>Generating the random array of 10,000, 2D points, and their
“center-of-mass”.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go"># find the mean x-coord and y-coord of the 10000 points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">center_of_mass</span> <span class="o">=</span> <span class="n">pts</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># -&gt; array([mean_x, mean_y])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">center_of_mass</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2,)</span>

<span class="go"># Use broadcasting to compute the position of each point relative</span>
<span class="go"># to the center of mass. The center of mass coordinates are subtracted</span>
<span class="go"># from each of the 10000 points, via broadcast-subtraction</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">relative_pos</span> <span class="o">=</span> <span class="n">pts</span> <span class="o">-</span> <span class="n">center_of_mass</span> <span class="c1"># shape-(10000,2) w/ shape-(2,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">relative_pos</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(10000, 2)</span>
</pre></div>
</div>
<p><strong>Broadcast Compatibility: Solution</strong></p>
<ol class="arabic simple">
<li>Incompatible</li>
<li><code class="docutils literal"><span class="pre">3</span> <span class="pre">x</span> <span class="pre">4</span></code></li>
<li><code class="docutils literal"><span class="pre">8</span> <span class="pre">x</span> <span class="pre">3</span> <span class="pre">x</span> <span class="pre">1</span></code></li>
<li><code class="docutils literal"><span class="pre">9</span> <span class="pre">x</span> <span class="pre">2</span> <span class="pre">x</span> <span class="pre">5</span></code></li>
<li>Incompatible</li>
</ol>
<p><strong>Basic Broadcasting II: Solution</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># a shape-(2, 3, 4) array</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
                   <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
                   <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]],</span>

                  <span class="p">[[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">]]])</span>


<span class="c1"># sum over each row, within a sheet</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">summed_rows</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">48</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">57</span><span class="p">]])</span>

<span class="c1"># this shape-(2,4) array can be broadcast-divided</span>
<span class="c1"># along the rows of `x`, if we insert a size-1 axis</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x_norm</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="n">summed_rows</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span>

<span class="c1"># verifying the solution</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x_norm</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">]])</span>
</pre></div>
</div>
<p><strong>Basic Broadcasting III: Solution</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># a collection of 500 48x48 RGB images</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">images</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="c1"># finding the max-value within each color-channel of each image</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">max_vals</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">max_vals</span><span class="o">.</span><span class="n">shape</span>
<span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="c1"># we can insert size-1 dimensions so that we can</span>
<span class="c1"># broadcast-divide these max-values with</span>
<span class="c1"># the pixels of the images.</span>
<span class="c1"># broadcasting (500, 48, 48, 3) with (500, 1, 1, 3)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">normed_images</span> <span class="o">=</span> <span class="n">images</span> <span class="o">/</span> <span class="n">max_vals</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="c1"># checking that all the max-values are 1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">normed_images</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">],</span>
       <span class="o">...</span><span class="p">,</span>
       <span class="p">[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">]])</span>

<span class="c1"># a rigorous check</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">normed_images</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
<span class="bp">True</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="VectorizedOperations.html" class="btn btn-neutral" title="“Vectorized” Operations: Optimized Computations on NumPy Arrays" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Ryan Soklaski.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'alpha',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>